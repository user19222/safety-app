<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××¤×œ×™×§×¦×™×™×ª ×‘×˜×™×—×•×ª - ×”×¨×¦×œ 28</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // Lucide Icons as SVG components
        const Camera = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path>
                <circle cx="12" cy="13" r="4"></circle>
            </svg>
        );

        const Users = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
        );

        const ClipboardCheck = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
                <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
                <path d="M9 14l2 2 4-4"></path>
            </svg>
        );

        const AlertTriangle = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                <line x1="12" y1="9" x2="12" y2="13"></line>
                <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
        );

        const Home = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                <polyline points="9 22 9 12 15 12 15 22"></polyline>
            </svg>
        );

        const FileText = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
            </svg>
        );

        const Plus = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
        );

        const ChevronLeft = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
        );

        const X = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        );

        const Menu = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="3" y1="12" x2="21" y2="12"></line>
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
        );

        const HardHat = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M2 18a1 1 0 0 0 1 1h18a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v2z"></path>
                <path d="M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5"></path>
                <path d="M4 15V9a8 8 0 0 1 16 0v6"></path>
            </svg>
        );

        const ChevronDown = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
        );

        const Globe = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="2" y1="12" x2="22" y2="12"></line>
                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
            </svg>
        );

        const translations = {
            he: {
                siteTitle: '×”×¨×¦×œ 28',
                newReport: '×“×™×•×•×— ××¤×’×¢ ×—×“×©',
                dailyChecklist: '×¦\'×§-×œ×™×¡×˜ ×™×•××™',
                openIncidents: '××¤×’×¢×™× ×¤×ª×•×—×™×',
                workerManagement: '× ×™×”×•×œ ×¢×•×‘×“×™×',
                dashboard: '×œ×•×— ×‘×§×¨×”',
                alerts: '×”×ª×¨××•×ª',
                search: '×—×™×¤×•×©',
                currentWorkers: '×¢×•×‘×“×™× × ×•×›×—×™×',
                safetyIndex: '××“×“ ×‘×˜×™×—×•×ª',
                reportIncident: '×“×™×•×•×— ××¤×’×¢',
                manageWorkers: '× ×™×”×•×œ ×¢×•×‘×“×™×',
                checklist: '×¦\'×§-×œ×™×¡×˜',
                incidents: '××¤×’×¢×™×',
                activeWorkers: '×¢×•×‘×“×™× ×¤×¢×™×œ×™×',
                userName: '×•×™×§×˜×•×¨ ×™××™×Ÿ',
                userRole: '××¤×§×— ×‘×˜×™×—×•×ª',
                generalLogbook: '× ×™×”×•×œ ×¤× ×§×¡ ×›×œ×œ×™',
                siteDocs: '××¡××›×™ ××ª×¨',
                other: '×©×•× ×•×ª',
                help: '×¢×–×¨×”',
                language: '×©×¤×”',
                logout: '×”×ª× ×ª×§',
                incidentDescription: '×ª×™××•×¨ ×”××¤×’×¢',
                descriptionPlaceholder: '×ª××¨ ××ª ×”××¤×’×¢...',
                severity: '×“×¨×’×ª ×—×•××¨×”',
                severe: '×—××•×¨×”',
                medium: '×‘×™× ×•× ×™×ª',
                low: '×§×œ×”',
                photoIncident: '×¦×™×œ×•× ××¤×’×¢',
                takePhoto: '×¦×œ× ×ª××•× ×”',
                submitReport: '×©×œ×— ×“×™×•×•×—',
                workAtHeight: '×¢×‘×•×“×” ×‘×’×•×‘×”',
                electrical: '×—×©××œ',
                scaffolding: '×¤×™×’×•××™×',
                saveChecklist: '×©××•×¨ ×¦\'×§-×œ×™×¡×˜',
                open: '×¤×ª×•×—',
                handled: '×˜×•×¤×œ',
                markAsHandled: '×œ×—×¥ ×œ×¡×™××•×Ÿ ×›×˜×•×¤×œ',
                status: '×¡×˜×˜×•×¡',
                safetyOfficer: '×¢×•×‘×“ ×‘×˜×™×—×•×ª ×¨××©×™',
                workManager: '×× ×”×œ ×¢×‘×•×“×”',
                location: '××™×§×•×',
                riskCategory: '×§×˜×’×•×¨×™×™×ª ×¡×™×›×•×Ÿ',
                description: '×ª×™××•×¨',
                contractor: '×§×‘×œ×Ÿ/××—×œ×§×”',
                photos: '×ª××•× ×•×ª',
                attachments: '××¡××›×™×',
                distributionList: '×¨×©×™××ª ×ª×¤×•×¦×”',
                incidentDetails: '×¤×¨×˜×™ ×”××¤×’×¢',
                safety: '×‘×˜×™×—×•×ª',
                humanResources: '×›×— ××“×',
                equipment2: '×¦×™×•×“',
                incidentsTab: '××¤×’×¢×™×',
                filterBy: '×¡× ×Ÿ ×œ×¤×™:',
                showing: '××¦×™×’',
                outOf: '××ª×•×š',
                noRecordsFound: '×œ× × ××¦××• ×¨×©×•××•×ª',
                summaryReport: '×“×•×— ××¨×•×›×–',
                checklistSaved: '×”×¦\'×§-×œ×™×¡×˜ × ×©××¨ ×‘×”×¦×œ×—×”!'
            },
            en: {
                siteTitle: 'Hertzel 28',
                newReport: 'New Incident Report',
                dailyChecklist: 'Daily Checklist',
                openIncidents: 'Open Incidents',
                workerManagement: 'Worker Management',
                dashboard: 'Dashboard',
                alerts: 'Alerts',
                search: 'Search',
                currentWorkers: 'Current Workers',
                safetyIndex: 'Safety Index',
                reportIncident: 'Report Incident',
                manageWorkers: 'Manage Workers',
                checklist: 'Checklist',
                incidents: 'Incidents',
                activeWorkers: 'Active Workers',
                userName: 'Victor Yamin',
                userRole: 'Safety Officer',
                generalLogbook: 'General Logbook Management',
                siteDocs: 'Site Documents',
                other: 'Other',
                help: 'Help',
                language: 'Language',
                logout: 'Logout',
                incidentDescription: 'Incident Description',
                descriptionPlaceholder: 'Describe the incident...',
                severity: 'Severity Level',
                severe: 'Severe',
                medium: 'Medium',
                low: 'Low',
                photoIncident: 'Incident Photo',
                takePhoto: 'Take Photo',
                submitReport: 'Submit Report',
                workAtHeight: 'Work at Height',
                electrical: 'Electrical',
                scaffolding: 'Scaffolding',
                saveChecklist: 'Save Checklist',
                open: 'Open',
                handled: 'Handled',
                markAsHandled: 'Click to mark as handled',
                status: 'Status',
                safetyOfficer: 'Chief Safety Officer',
                workManager: 'Work Manager',
                location: 'Location',
                riskCategory: 'Risk Category',
                description: 'Description',
                contractor: 'Contractor/Department',
                photos: 'Photos',
                attachments: 'Attachments',
                distributionList: 'Distribution List',
                incidentDetails: 'Incident Details',
                safety: 'Safety',
                humanResources: 'Human Resources',
                equipment2: 'Equipment',
                incidentsTab: 'Incidents',
                filterBy: 'Filter by:',
                showing: 'Showing',
                outOf: 'out of',
                noRecordsFound: 'No records found',
                summaryReport: 'Summary Report',
                checklistSaved: 'Checklist saved successfully!'
            }
        };

        function SafetyApp() {
            const [currentPage, setCurrentPage] = useState('dashboard');
            const [sidebarOpen, setSidebarOpen] = useState(false);
            const [language, setLanguage] = useState('he');
            const [showLanguageMenu, setShowLanguageMenu] = useState(false);
            const [expandedSections, setExpandedSections] = useState({
                general: false,
                documents: false,
                other: false,
                help: false
            });
            const [incidents, setIncidents] = useState([
                { 
                    id: 1, 
                    description: '×¢×‘×•×“×” ×‘×’×•×‘×” ×œ×œ× ×¨×ª××”', 
                    descriptionEn: 'Work at height without harness', 
                    severity: '×—××•×¨×”', 
                    severityEn: 'Severe', 
                    status: '×¤×ª×•×—', 
                    statusEn: 'Open', 
                    date: '15/01/2026',
                    location: '×§×•××” 3',
                    riskCategory: '×¢×‘×•×“×” ×‘×’×•×‘×”',
                    contractor: '×§×‘×œ×Ÿ ×¨××©×™',
                    image: null 
                },
                { 
                    id: 2, 
                    description: '×¤×™×’×•× ×œ× ×××•×‘×˜×—', 
                    descriptionEn: 'Unsecured scaffolding', 
                    severity: '×‘×™× ×•× ×™×ª', 
                    severityEn: 'Medium', 
                    status: '×¤×ª×•×—', 
                    statusEn: 'Open', 
                    date: '14/01/2026',
                    location: '×§×•××” 2',
                    riskCategory: '×¤×™×’×•××™×',
                    contractor: '×§×‘×œ×Ÿ ××©× ×”',
                    image: null 
                }
            ]);
            const [workers, setWorkers] = useState([
                { id: 1, name: '×•×™×§×˜×•×¨ ×™××™×Ÿ', nameEn: 'Victor Yamin', role: '×¢×•×‘×“ ×‘×˜×™×—×•×ª ×¨××©×™', roleEn: 'Chief Safety Officer' },
                { id: 2, name: '×©××•×œ×™ ××‘×’×‘× ×™', nameEn: 'Shauli Avigbeni', role: '×× ×”×œ ×¢×‘×•×“×”', roleEn: 'Work Manager' }
            ]);

            const stats = {
                activeIncidents: incidents.filter(i => i.status === '×¤×ª×•×—' || i.status === 'Open').length,
                totalWorkers: workers.length
            };

            const toggleSection = (section) => {
                setExpandedSections({
                    ...expandedSections,
                    [section]: !expandedSections[section]
                });
            };

            const t = translations[language];
            const isRTL = language === 'he';

            return (
                <div className="min-h-screen bg-gray-50" dir={isRTL ? 'rtl' : 'ltr'}>
                    {sidebarOpen && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 z-40" onClick={() => setSidebarOpen(false)} />
                    )}

                    <div className={`fixed top-0 ${isRTL ? 'right-0' : 'left-0'} h-full w-80 bg-white shadow-2xl z-50 transform transition-transform duration-300 ${sidebarOpen ? 'translate-x-0' : isRTL ? 'translate-x-full' : '-translate-x-full'}`}>
                        <div className="p-4 bg-gradient-to-r from-blue-900 to-blue-700 text-white">
                            <div className="flex items-center gap-3 mb-4">
                                <div className="bg-white rounded-full p-3">
                                    <HardHat size={32} className="text-blue-900" />
                                </div>
                                <div className="flex-1">
                                    <h2 className="font-bold text-lg">{t.userName}</h2>
                                    <p className="text-sm text-blue-100">{t.userRole}</p>
                                </div>
                            </div>
                        </div>

                        <div className="overflow-y-auto h-[calc(100%-180px)]">
                            <div className="border-b border-gray-200 relative">
                                <button onClick={() => setShowLanguageMenu(!showLanguageMenu)} className={`w-full flex items-center gap-3 px-4 py-4 hover:bg-gray-50 transition-colors ${isRTL ? 'text-right' : 'text-left'}`}>
                                    <Globe size={20} className="text-gray-400" />
                                    <span className="flex-1 text-sm font-medium">{t.language}</span>
                                    <span className="text-sm text-blue-600">{language === 'he' ? '×¢×‘×¨×™×ª' : 'English'}</span>
                                    <ChevronDown size={16} className={`text-gray-400 transform transition-transform ${showLanguageMenu ? 'rotate-180' : ''}`} />
                                </button>
                                
                                {showLanguageMenu && (
                                    <div className="bg-white border-t border-gray-200">
                                        <button onClick={() => { setLanguage('he'); setShowLanguageMenu(false); }} className={`w-full px-4 py-3 ${isRTL ? 'text-right' : 'text-left'} hover:bg-blue-50 transition-colors ${language === 'he' ? 'bg-blue-50 text-blue-600 font-medium' : 'text-gray-700'}`}>
                                            ×¢×‘×¨×™×ª
                                        </button>
                                        <button onClick={() => { setLanguage('en'); setShowLanguageMenu(false); }} className={`w-full px-4 py-3 ${isRTL ? 'text-right' : 'text-left'} hover:bg-blue-50 transition-colors ${language === 'en' ? 'bg-blue-50 text-blue-600 font-medium' : 'text-gray-700'}`}>
                                            English
                                        </button>
                                    </div>
                                )}
                            </div>

                            <div className="p-4 border-t">
                                <button className="w-full bg-red-600 text-white rounded-lg py-3 font-bold hover:bg-red-700">
                                    {t.logout}
                                </button>
                            </div>
                        </div>
                    </div>

                    <header className="bg-gradient-to-r from-blue-900 to-blue-700 text-white p-4 shadow-lg">
                        <div className="flex items-center justify-between">
                            <button onClick={() => setSidebarOpen(true)} className="p-2">
                                <Menu size={24} />
                            </button>
                            <h1 className="text-xl font-bold flex-1 text-center">
                                {currentPage === 'dashboard' && t.siteTitle}
                                {currentPage === 'report' && t.newReport}
                                {currentPage === 'checklist' && t.dailyChecklist}
                                {currentPage === 'incidents' && t.openIncidents}
                                {currentPage === 'workers' && t.workerManagement}
                            </h1>
                            {currentPage !== 'dashboard' && (
                                <button onClick={() => setCurrentPage('dashboard')} className="p-2">
                                    <ChevronLeft size={24} />
                                </button>
                            )}
                            {currentPage === 'dashboard' && <div className="w-10"></div>}
                        </div>
                    </header>

                    <main className="pb-20">
                        {currentPage === 'dashboard' && <Dashboard stats={stats} setCurrentPage={setCurrentPage} t={t} />}
                        {currentPage === 'report' && <ReportIncident setCurrentPage={setCurrentPage} incidents={incidents} setIncidents={setIncidents} t={t} isRTL={isRTL} language={language} />}
                        {currentPage === 'incidents' && <IncidentsList incidents={incidents} setIncidents={setIncidents} t={t} isRTL={isRTL} language={language} />}
                        {currentPage === 'workers' && <WorkersList workers={workers} t={t} isRTL={isRTL} language={language} />}
                    </main>

                    <nav className="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg">
                        <div className="flex justify-around p-2">
                            <NavButton icon={<Home size={24} />} label={t.dashboard} active={currentPage === 'dashboard'} onClick={() => setCurrentPage('dashboard')} />
                            <NavButton icon={<AlertTriangle size={24} />} label={t.alerts} onClick={() => setCurrentPage('incidents')} />
                            <NavButton icon={<FileText size={24} />} label={t.search} />
                        </div>
                    </nav>

                    {currentPage === 'dashboard' && (
                        <button onClick={() => setCurrentPage('report')} className="fixed bottom-20 left-1/2 transform -translate-x-1/2 bg-blue-600 text-white rounded-full p-4 shadow-2xl hover:bg-blue-700 transition-all">
                            <Plus size={32} />
                        </button>
                    )}
                </div>
            );
        }

        function Dashboard({ stats, setCurrentPage, t }) {
            const quickActions = [
                { icon: <Camera size={32} className="text-pink-600" />, action: () => setCurrentPage('report') },
                { icon: <Users size={32} className="text-purple-600" />, action: () => setCurrentPage('workers') },
                { icon: <ClipboardCheck size={32} className="text-blue-600" /> },
                { icon: <AlertTriangle size={32} className="text-yellow-600" /> }
            ];

            return (
                <div className="p-4 space-y-4">
                    <div className="grid grid-cols-2 gap-4">
                        <StatCard icon={<Users size={40} />} value={stats.totalWorkers} label={t.currentWorkers} />
                        <StatCard icon={<FileText size={40} />} value={9} label={t.safetyIndex} />
                    </div>

                    <div className="grid grid-cols-4 gap-3">
                        {quickActions.map((action, idx) => (
                            <button key={idx} onClick={action.action} className="bg-white rounded-xl p-4 shadow-md hover:shadow-lg transition-shadow flex flex-col items-center justify-center">
                                {action.icon}
                            </button>
                        ))}
                    </div>

                    <div className="space-y-3">
                        <Card title={t.activeWorkers} value={9} onClick={() => setCurrentPage('workers')} />
                    </div>
                </div>
            );
        }

        function ReportIncident({ setCurrentPage, incidents, setIncidents, t, isRTL, language }) {
            const [formData, setFormData] = useState({
                description: '',
                location: '',
                riskCategory: '',
                contractor: '',
                image: null
            });
            const [imagePreview, setImagePreview] = useState(null);
            const [showRiskMenu, setShowRiskMenu] = useState(false);

            const riskCategories = language === 'he' ? [
                '×©×™×œ×•×˜/×¡×™××•×Ÿ',
                '×¡×•×œ××•×ª/××©×˜×—×™ ×¢×‘×•×“×”',
                '×—×œ×œ ××•×§×£ - ×—×“×¨ ×¡×’×•×¨ ×œ×œ× ××•×•×¨×•×¨',
                '×—×©××œ ×¦×™×•×“ ×•×›×œ×™× ×—×©××œ×™×™×',
                '×’×™×“×•×¨ ××¤× ×™ × ×¤×™×œ×”',
                '×—×¤×™×¨×•×ª/×©×•×—×•×ª',
                '×¦×™×•×“ ××’×Ÿ ××™×©×™',
                '×¦×"×”',
                '×”×™×¢×¨×›×•×ª ×œ×—×™×¨×•×'
            ] : [
                'Signage/Marking',
                'Ladders/Work Platforms',
                'Confined Space',
                'Electrical Equipment',
                'Fall Protection',
                'Excavations/Pits',
                'PPE',
                'Heavy Equipment',
                'Emergency Preparedness'
            ];

            const handleImageCapture = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onloadend = () => {
                        setImagePreview(reader.result);
                        setFormData({ ...formData, image: reader.result });
                    };
                    reader.readAsDataURL(file);
                }
            };

            const handleSubmit = () => {
                const newIncident = {
                    id: incidents.length + 1,
                    description: formData.description,
                    descriptionEn: formData.description,
                    severity: language === 'he' ? '×‘×™× ×•× ×™×ª' : 'Medium',
                    severityEn: 'Medium',
                    location: formData.location,
                    riskCategory: formData.riskCategory,
                    contractor: formData.contractor,
                    status: language === 'he' ? '×¤×ª×•×—' : 'Open',
                    statusEn: 'Open',
                    date: new Date().toLocaleDateString(language === 'he' ? 'he-IL' : 'en-US'),
                    image: formData.image
                };
                setIncidents([newIncident, ...incidents]);
                setCurrentPage('dashboard');
            };

            return (
                <div className="p-4 space-y-4">
                    <h2 className={`text-lg font-bold ${isRTL ? 'text-right' : 'text-left'}`}>{t.incidentDetails}</h2>
                    
                    <div className="bg-white rounded-xl p-4 shadow-md">
                        <label className={`block text-sm font-bold mb-2 ${isRTL ? 'text-right' : 'text-left'}`}>{t.photos} *</label>
                        <input type="file" accept="image/*" capture="environment" onChange={handleImageCapture} className="hidden" id="camera-input" />
                        <div className="flex gap-3 justify-center items-center">
                            <label htmlFor="camera-input" className="bg-gray-200 rounded-lg p-12 cursor-pointer hover:bg-gray-300 flex items-center justify-center">
                                <Camera size={40} className="text-gray-500" />
                            </label>
                            <button className="bg-gray-200 rounded-lg p-12 flex items-center justify-center">
                                <FileText size={40} className="text-gray-500" />
                            </button>
                        </div>
                        {imagePreview && (
                            <div className="mt-3 relative">
                                <img src={imagePreview} alt="Preview" className="w-full rounded-lg" />
                                <button onClick={() => { setImagePreview(null); setFormData({ ...formData, image: null }); }} className={`absolute top-2 ${isRTL ? 'left-2' : 'right-2'} bg-red-600 text-white rounded-full p-1`}>
                                    <X size={20} />
                                </button>
                            </div>
                        )}
                    </div>

                    <div className="bg-white rounded-xl p-4 shadow-md">
                        <label className={`block text-sm font-bold mb-2 ${isRTL ? 'text-right' : 'text-left'}`}>{t.location} *</label>
                        <input type="text" value={formData.location} onChange={(e) => setFormData({ ...formData, location: e.target.value })} className={`w-full border border-gray-300 rounded-lg p-3 ${isRTL ? 'text-right' : 'text-left'}`} />
                    </div>

                    <div className="bg-white rounded-xl p-4 shadow-md relative">
                        <label className={`block text-sm font-bold mb-2 ${isRTL ? 'text-right' : 'text-left'}`}>{t.riskCategory} *</label>
                        <button onClick={() => setShowRiskMenu(!showRiskMenu)} className={`w-full border border-gray-300 rounded-lg p-3 ${isRTL ? 'text-right' : 'text-left'} flex items-center justify-between bg-white`}>
                            <ChevronDown size={20} className={`transform ${showRiskMenu ? 'rotate-180' : ''}`} />
                            <span className="text-gray-500">{formData.riskCategory || ''}</span>
                        </button>
                        
                        {showRiskMenu && (
                            <div className="absolute top-full left-0 right-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-lg z-50 max-h-80 overflow-y-auto">
                                {riskCategories.map((category, idx) => (
                                    <button key={idx} onClick={() => { setFormData({ ...formData, riskCategory: category }); setShowRiskMenu(false); }} className={`w-full px-4 py-3 hover:bg-gray-100 ${isRTL ? 'text-right' : 'text-left'} border-b border-gray-100`}>
                                        {category}
                                    </button>
                                ))}
                            </div>
                        )}
                    </div>

                    <div className="bg-white rounded-xl p-4 shadow-md">
                        <label className={`block text-sm font-bold mb-2 ${isRTL ? 'text-right' : 'text-left'}`}>{t.description} *</label>
                        <textarea value={formData.description} onChange={(e) => setFormData({ ...formData, description: e.target.value })} className={`w-full border border-gray-300 rounded-lg p-3 ${isRTL ? 'text-right' : 'text-left'}`} rows="4" placeholder={t.descriptionPlaceholder} />
                    </div>

                    <div className="bg-white rounded-xl p-4 shadow-md">
                        <label className={`block text-sm font-bold mb-2 ${isRTL ? 'text-right' : 'text-left'}`}>{t.contractor} *</label>
                        <input type="text" value={formData.contractor} onChange={(e) => setFormData({ ...formData, contractor: e.target.value })} className={`w-full border border-gray-300 rounded-lg p-3 ${isRTL ? 'text-right' : 'text-left'}`} />
                    </div>

                    <button onClick={handleSubmit} disabled={!formData.description || !formData.location || !formData.riskCategory} className="w-full bg-green-600 text-white rounded-lg p-4 font-bold text-lg disabled:bg-gray-400 disabled:cursor-not-allowed hover:bg-green-700">
                        {t.submitReport}
                    </button>
                </div>
            );
        }

        function IncidentsList({ incidents, setIncidents, t, isRTL, language }) {
            const [selectedIncident, setSelectedIncident] = useState(null);

            const handleToggleStatus = (id) => {
                setIncidents(incidents.map(inc => {
                    if (inc.id === id) {
                        const isOpen = inc.status === '×¤×ª×•×—' || inc.status === 'Open';
                        return {
                            ...inc,
                            status: isOpen ? (language === 'he' ? '×˜×•×¤×œ' : 'Handled') : (language === 'he' ? '×¤×ª×•×—' : 'Open'),
                            statusEn: isOpen ? 'Handled' : 'Open'
                        };
                    }
                    return inc;
                }));
            };

            const getDisplayText = (incident, field) => {
                if (language === 'he') {
                    return incident[field];
                }
                return incident[field + 'En'] || incident[field];
            };

            return (
                <div className="p-4 space-y-3">
                    {incidents.map((incident) => {
                        const displayStatus = getDisplayText(incident, 'status');
                        const isOpen = displayStatus === '×¤×ª×•×—' || displayStatus === 'Open';
                        
                        return (
                            <div key={incident.id} className="bg-white rounded-xl p-4 shadow-md cursor-pointer hover:shadow-lg transition-shadow" onClick={() => setSelectedIncident(incident)}>
                                <div className={`flex ${isRTL ? 'flex-row-reverse' : ''} justify-between items-start mb-2`}>
                                    <span className={`px-3 py-1 rounded-full text-sm font-bold ${
                                        getDisplayText(incident, 'severity') === '×—××•×¨×”' || getDisplayText(incident, 'severity') === 'Severe' ? 'bg-red-100 text-red-700' :
                                        getDisplayText(incident, 'severity') === '×‘×™× ×•× ×™×ª' || getDisplayText(incident, 'severity') === 'Medium' ? 'bg-yellow-100 text-yellow-700' :
                                        'bg-green-100 text-green-700'
                                    }`}>
                                        {getDisplayText(incident, 'severity')}
                                    </span>
                                    <span className="text-gray-500 text-sm">{incident.date}</span>
                                </div>
                                <p className={`${isRTL ? 'text-right' : 'text-left'} mb-2 font-medium`}>{getDisplayText(incident, 'description')}</p>
                                {incident.location && (
                                    <p className={`${isRTL ? 'text-right' : 'text-left'} text-sm text-gray-600 mb-2`}>
                                        ğŸ“ {incident.location}
                                    </p>
                                )}
                                {incident.image && (
                                    <img src={incident.image} alt="Incident" className="w-full rounded-lg mb-3" />
                                )}
                                <div className={`flex items-center justify-center gap-2 py-2 rounded-lg font-bold ${
                                    isOpen ? 'bg-red-100 text-red-700' : 'bg-green-100 text-green-700'
                                }`}>
                                    {isOpen ? `âš ï¸ ${t.open}` : `âœ“ ${t.handled}`}
                                </div>
                            </div>
                        );
                    })}

                    {selectedIncident && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-end" onClick={() => setSelectedIncident(null)}>
                            <div className="bg-white rounded-t-3xl w-full max-h-[90vh] overflow-y-auto" onClick={(e) => e.stopPropagation()}>
                                <div className="sticky top-0 bg-gradient-to-r from-blue-900 to-blue-700 text-white p-4 flex items-center justify-between rounded-t-3xl">
                                    <button onClick={() => setSelectedIncident(null)}>
                                        <X size={24} />
                                    </button>
                                    <h2 className="text-xl font-bold">{language === 'he' ? '×¤×¨×˜×™ ××¤×’×¢' : 'Incident Details'}</h2>
                                    <div className="w-6"></div>
                                </div>
                                
                                <div className="p-6 space-y-4">
                                    <div className="flex justify-center">
                                        <span className={`px-6 py-2 rounded-full text-lg font-bold ${
                                            getDisplayText(selectedIncident, 'severity') === '×—××•×¨×”' || getDisplayText(selectedIncident, 'severity') === 'Severe' ? 'bg-red-100 text-red-700' :
                                            getDisplayText(selectedIncident, 'severity') === '×‘×™× ×•× ×™×ª' || getDisplayText(selectedIncident, 'severity') === 'Medium' ? 'bg-yellow-100 text-yellow-700' :
                                            'bg-green-100 text-green-700'
                                        }`}>
                                            {getDisplayText(selectedIncident, 'severity')}
                                        </span>
                                    </div>

                                    <div className={`${isRTL ? 'text-right' : 'text-left'}`}>
                                        <p className="text-sm text-gray-500">{language === 'he' ? '×ª××¨×™×š' : 'Date'}</p>
                                        <p className="text-lg font-medium">{selectedIncident.date}</p>
                                    </div>

                                    <div className={`${isRTL ? 'text-right' : 'text-left'}`}>
                                        <p className="text-sm text-gray-500 mb-1">{t.description}</p>
                                        <p className="text-lg">{getDisplayText(selectedIncident, 'description')}</p>
                                    </div>

                                    {selectedIncident.location && (
                                        <div className={`${isRTL ? 'text-right' : 'text-left'}`}>
                                            <p className="text-sm text-gray-500 mb-1">{t.location}</p>
                                            <p className="text-lg">ğŸ“ {selectedIncident.location}</p>
                                        </div>
                                    )}

                                    {selectedIncident.riskCategory && (
                                        <div className={`${isRTL ? 'text-right' : 'text-left'}`}>
                                            <p className="text-sm text-gray-500 mb-1">{t.riskCategory}</p>
                                            <p className="text-lg">{selectedIncident.riskCategory}</p>
                                        </div>
                                    )}

                                    {selectedIncident.image && (
                                        <div>
                                            <p className={`text-sm text-gray-500 mb-2 ${isRTL ? 'text-right' : 'text-left'}`}>{t.photos}</p>
                                            <img src={selectedIncident.image} alt="Incident" className="w-full rounded-lg" />
                                        </div>
                                    )}

                                    <div className="space-y-3 pt-4">
                                        <button onClick={() => { handleToggleStatus(selectedIncident.id); setSelectedIncident(null); }} className={`w-full py-3 rounded-lg font-bold text-lg ${
                                            selectedIncident.status === '×¤×ª×•×—' || selectedIncident.status === 'Open'
                                                ? 'bg-green-600 text-white hover:bg-green-700' 
                                                : 'bg-blue-600 text-white hover:bg-blue-700'
                                        }`}>
                                            {selectedIncident.status === '×¤×ª×•×—' || selectedIncident.status === 'Open' 
                                                ? `âœ“ ${language === 'he' ? '×¡××Ÿ ×›×˜×•×¤×œ' : 'Mark as Handled'}` 
                                                : `â†» ${language === 'he' ? '×¤×ª×— ××—×“×©' : 'Reopen'}`}
                                        </button>
                                        
                                        <button onClick={() => setSelectedIncident(null)} className="w-full py-3 rounded-lg font-bold text-lg bg-gray-200 text-gray-700 hover:bg-gray-300">
                                            {language === 'he' ? '×¡×’×•×¨' : 'Close'}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        function WorkersList({ workers, t, isRTL, language }) {
            return (
                <div className="p-4 space-y-3">
                    {workers.map((worker) => (
                        <div key={worker.id} className={`bg-white rounded-xl p-4 shadow-md flex items-center gap-4 ${isRTL ? 'flex-row-reverse' : ''}`}>
                            <div className="bg-blue-100 rounded-full p-3">
                                <Users size={32} className="text-blue-600" />
                            </div>
                            <div className={`flex-1 ${isRTL ? 'text-right' : 'text-left'}`}>
                                <h3 className="font-bold text-lg">{language === 'he' ? worker.name : worker.nameEn}</h3>
                                <p className="text-gray-600">{language === 'he' ? worker.role : worker.roleEn}</p>
                            </div>
                        </div>
                    ))}
                </div>
            );
        }

        function StatCard({ icon, value, label }) {
            return (
                <div className="bg-white rounded-xl p-4 shadow-md text-center">
                    <div className="flex justify-center text-gray-400 mb-2">{icon}</div>
                    <div className="text-3xl font-bold text-blue-600">{value}</div>
                    <div className="text-sm text-gray-600 mt-1">{label}</div>
                </div>
            );
        }

        function Card({ title, value, onClick }) {
            return (
                <div onClick={onClick} className={`bg-white rounded-xl p-4 shadow-md flex justify-between items-center ${onClick ? 'cursor-pointer hover:shadow-lg' : ''}`}>
                    <span className="text-2xl font-bold text-blue-600">{value}</span>
                    <span className="text-right flex-1 mr-3 font-medium">{title}</span>
                </div>
            );
        }

        function NavButton({ icon, label, active, onClick }) {
            return (
                <button onClick={onClick} className={`flex flex-col items-center gap-1 px-4 py-2 rounded-lg transition-colors ${active ? 'text-blue-600' : 'text-gray-500'}`}>
                    {icon}
                    <span className="text-xs">{label}</span>
                </button>
            );
        }

        ReactDOM.render(<SafetyApp />, document.getElementById('root'));
    </script>
</body>
</html>